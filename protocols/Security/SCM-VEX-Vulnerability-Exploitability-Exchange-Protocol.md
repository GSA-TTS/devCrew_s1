# SCM-VEX: Vulnerability Exploitability Exchange Protocol

**Version**: 1.0
**Last Updated**: 2025-11-18
**Status**: Active
**Owner**: Security-Auditor

## Objective

Implement Vulnerability Exploitability Exchange (VEX) protocol providing structured, contextual assessment of vulnerability exploitability in software components, enabling informed security decisions, reducing false positive vulnerability alerts through application-specific analysis, automating remediation prioritization based on actual risk, and ensuring compliance with CISA VEX guidance for supply chain security transparency across all software artifacts with machine-readable VEX documents.

## Tool Requirements

- **TOOL-SEC-004** (Vulnerability Management): VEX document generation and vulnerability exploitability assessment
  - Execute: VEX document creation, vulnerability analysis, exploitability assessment, risk prioritization, remediation coordination
  - Integration: VEX generators, vulnerability databases, exploitability analysis tools, risk assessment frameworks
  - Usage: VEX document automation, exploitability analysis, vulnerability triage, risk-based prioritization

- **TOOL-SEC-003** (SCA Scanner): Vulnerability discovery and SBOM integration for VEX context
  - Execute: Vulnerability scanning, SBOM correlation, dependency analysis, component-level vulnerability assessment
  - Integration: SBOM tools, vulnerability scanners, dependency analyzers, component databases
  - Usage: Vulnerability discovery, SBOM-VEX correlation, component analysis, dependency risk assessment

- **TOOL-SEC-008** (Threat Intelligence): Threat context and exploitability intelligence for VEX assessments
  - Execute: Threat intelligence correlation, exploit availability analysis, attack pattern analysis, threat landscape assessment
  - Integration: Threat intelligence feeds, exploit databases, attack pattern repositories, threat analysis platforms
  - Usage: Threat-informed VEX analysis, exploit correlation, attack pattern assessment, threat context integration

- **TOOL-COLLAB-001** (GitHub Integration): VEX documentation, team coordination, and approval workflows
  - Execute: VEX document management, team coordination, approval workflows, documentation version control
  - Integration: CLI commands (gh, git), API calls, repository operations, documentation management, collaboration workflows
  - Usage: VEX workflow coordination, documentation management, team collaboration, approval tracking

- **TOOL-SEC-011** (Compliance): VEX compliance validation and regulatory reporting
  - Execute: VEX compliance validation, CISA guidance compliance, regulatory reporting, audit trail maintenance
  - Integration: Compliance frameworks, VEX validators, regulatory platforms, audit systems, governance tools
  - Usage: VEX compliance validation, regulatory compliance, audit preparation, governance enforcement

## Trigger

- SBOM vulnerability analysis completion identifying CVEs in dependencies
- CVE discovery in software components requiring exploitability assessment
- Vulnerability scanner output requiring triage and prioritization
- Security audit requesting exploitability justification for known vulnerabilities
- Deployment gate requiring VEX attestation for vulnerability approval
- Scheduled vulnerability reassessment (monthly or per release)
- Emergency CVE response requiring rapid exploitability determination
- Compliance audit requiring VEX documentation for accepted vulnerabilities
- Customer or partner requesting VEX statements for software components
- Integration with P-SEC-VULN for vulnerability management workflows

## Agents

**Primary**: Security-Auditor
**Supporting**: DevOps-Engineer, Backend-Engineer, Infrastructure-Engineer, SRE
**Review**: CISO, Security-Architecture-Board, Vulnerability-Management-Team
**Orchestration**: Orchestrator (CORE-COORD-002 hub-and-spoke coordination)

## Prerequisites

- Software Bill of Materials (SBOM) with complete dependency inventory (SCM-SBOM protocol output)
- CVE database access (NVD, MITRE, OSV, GitHub Security Advisories)
- Vulnerability scanning results from SAST/DAST/SCA tools
- Component usage analysis capabilities (static and dynamic code analysis)
- Attack surface analysis tools and methodologies
- VEX generation tools (CycloneDX CLI, OpenVEX tools)
- Vulnerability management system integration
- Security analysis expertise and threat intelligence feeds

## Steps

### Step 1: Vulnerability Inventory and SBOM Integration (Estimated Time: 15 minutes)

**Action**: Security-Auditor with DevOps-Engineer analyze SBOM and compile vulnerability inventory from multiple sources

**Expected Outcome**: Complete vulnerability inventory with CVE IDs, affected components, severity scores, and vulnerability descriptions
**Validation**: All SBOM components scanned, CVEs matched, CVSS scores retrieved, vulnerability metadata complete

### Step 2: Application Context Analysis and Component Usage Assessment (Estimated Time: 30 minutes)

**Action**: Security-Auditor with Backend-Engineer analyze component usage patterns, network exposure, and attack surface

**Context Analysis Framework**:
```python
class ComponentUsageAnalyzer:
    def analyze_component_context(self, component, application):
        """Analyze how component is used within application context"""
        return {
            'usage_pattern': self._determine_usage_pattern(component, application),
            'network_exposure': self._assess_network_exposure(component, application),
            'attack_surface': self._calculate_attack_surface(component, application),
            'security_controls': self._identify_security_controls(component, application),
            'execution_context': self._analyze_execution_context(component)
        }

    def _determine_usage_pattern(self, component, application):
        """Determine if vulnerable function/API is actually used"""
        # Static code analysis to check if vulnerable code paths are invoked
        vulnerable_functions = component.get_vulnerable_functions()
        application_callgraph = application.get_callgraph()

        used_vulnerable_functions = []
        for func in vulnerable_functions:
            if application_callgraph.calls(func):
                used_vulnerable_functions.append(func)

        return {
            'vulnerable_functions_total': len(vulnerable_functions),
            'vulnerable_functions_used': len(used_vulnerable_functions),
            'usage_status': 'in_use' if used_vulnerable_functions else 'not_used'
        }

    def _assess_network_exposure(self, component, application):
        """Assess if component is reachable from untrusted networks"""
        return {
            'internet_facing': application.is_internet_facing(),
            'network_boundaries': application.get_network_boundaries(),
            'access_controls': application.get_network_access_controls(),
            'exposure_level': 'high' if application.is_internet_facing() else 'low'
        }
```

**Expected Outcome**: Detailed context analysis showing component usage, network exposure, and exploitability surface
**Validation**: Usage patterns documented, network exposure assessed, attack surface calculated

### Step 3: Exploitability Evaluation with STRIDE and Attack Analysis (Estimated Time: 45 minutes)

**Action**: Security-Auditor evaluate actual exploitability based on context, security controls, and threat intelligence

**Exploitability Assessment**:
- **Not Exploitable**: Vulnerable code not used, no network exposure, mitigating controls effective
- **Exploitable**: Vulnerable code used, network exposure exists, no effective mitigations
- **Under Investigation**: Insufficient information, complex scenario, expert analysis required

**Expected Outcome**: Exploit ability determination for each vulnerability with detailed justification
**Validation**: All vulnerabilities assessed, rationale documented, risk classification assigned

### Step 4: VEX Document Generation (CycloneDX Format) (Estimated Time: 20 minutes)

**Action**: DevOps-Engineer generate machine-readable VEX document in CycloneDX 1.4 format

**VEX Generation**:
```bash
#!/bin/bash
# VEX Document Generation

SBOM_FILE="$1"
ASSESSMENT_FILE="$2"
OUTPUT_FILE="$3"

# Generate CycloneDX VEX document
cat > "$OUTPUT_FILE" <<EOF
{
  "bomFormat": "CycloneDX",
  "specVersion": "1.4",
  "version": 1,
  "metadata": {
    "timestamp": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
    "component": $(jq '.metadata.component' "$SBOM_FILE")
  },
  "vulnerabilities": [
    {
      "id": "CVE-2023-XXXXX",
      "source": {"name": "NVD", "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-XXXXX"},
      "ratings": [{"severity": "high", "score": 7.5, "method": "CVSSv3"}],
      "analysis": {
        "state": "not_affected",
        "justification": "code_not_reachable",
        "response": ["will_not_fix"],
        "detail": "Vulnerable function is not invoked in application code paths"
      },
      "affects": [{"ref": "pkg:npm/vulnerable-package@1.0.0"}]
    }
  ]
}
EOF
```

**Expected Outcome**: CycloneDX VEX document generated with exploitability assessments and justifications
**Validation**: VEX schema valid, all vulnerabilities included, justifications complete

### Step 5: Risk Classification and Remediation Prioritization (Estimated Time: 20 minutes)

**Action**: Security-Auditor classify vulnerabilities by actual risk and prioritize remediation efforts

**Expected Outcome**: Risk-based remediation roadmap with prioritized vulnerability list
**Validation**: Vulnerabilities prioritized, remediation timeline established, resources allocated

### Step 6: VEX Distribution and Vulnerability Management Integration (Estimated Time: 15 minutes)

**Action**: DevOps-Engineer publish VEX document with SBOM and integrate with vulnerability management systems

**Expected Outcome**: VEX document distributed with software artifacts and integrated into vulnerability tracking
**Validation**: VEX accessible via artifact registry, vulnerability management system updated

### Step 7: Periodic Reassessment and VEX Maintenance (Estimated Time: 15 minutes)

**Action**: Security-Auditor schedule periodic VEX reassessment to account for environment changes

**Expected Outcome**: VEX maintenance schedule established with automated reassessment triggers
**Validation**: Reassessment triggers configured, VEX versioning implemented, change tracking active

## Expected Outputs

- **Primary Artifact**: `vex.cdx.json` - CycloneDX 1.4 VEX document with exploitability assessments
- **Assessment Report**: Detailed vulnerability analysis with exploitability justifications
- **Risk Matrix**: Prioritized vulnerability list with remediation recommendations
- **Integration Data**: Vulnerability management system updates with VEX findings
- **Attestation Statement**: VEX statement for customer/partner sharing
- **Remediation Roadmap**: Prioritized remediation timeline with resource allocation
- **False Positive Reduction Metrics**: Before/after comparison of actionable vulnerabilities
- **Success Indicators**: ≥40% false positive reduction, 100% VEX coverage for SBOM vulnerabilities

## Rollback/Recovery

**Trigger**: Critical failure during Steps 2-7 (context analysis, exploitability assessment, VEX generation)

**Standard Approach**: Invoke **P-RECOVERY** protocol for VEX regeneration and reassessment

**P-RECOVERY Integration**:
1. Before Step 2: CreateBranch to create isolated VEX analysis workspace (`vex_${BUILD_ID}_${timestamp}`)
2. Execute Steps 2-7 with checkpoints after context analysis, exploitability assessment, VEX generation
3. On success: MergeBranch commits VEX artifacts and vulnerability management updates atomically
4. On failure: DiscardBranch triggers reassessment, preserves analysis artifacts
5. P-RECOVERY handles retry logic with exponential backoff (3 assessment attempts)
6. P-RECOVERY escalates to NotifyHuman if VEX generation persistently fails

**Custom Rollback** (VEX-specific):
1. If context analysis insufficient: Document assumptions, mark vulnerabilities as "under investigation"
2. If exploitability assessment uncertain: Escalate to senior security analyst, convene security review
3. If VEX generation failure: Use manual VEX templates, validate schema compliance
4. If integration failure: Use fallback vulnerability reporting, queue for retry

**Verification**: VEX document valid and published, vulnerability management system updated, false positives reduced
**Data Integrity**: Medium risk - VEX assessments must accurately reflect application context

## Failure Handling

### Failure Scenario 1: Insufficient Application Context for Assessment
- **Symptoms**: Unable to determine component usage, network exposure unclear, attack surface unknown
- **Root Cause**: Incomplete documentation, dynamic code analysis unavailable, complex application architecture
- **Impact**: High - Cannot accurately assess exploitability, risk of false negatives or false positives
- **Resolution**:
  1. Request additional technical documentation from development teams
  2. Conduct manual code review to determine component usage
  3. Perform dynamic application testing to observe runtime behavior
  4. Document assumptions and mark vulnerabilities as "under investigation"
  5. Escalate to application architects for clarification
- **Prevention**: Mandatory architecture documentation, automated usage analysis, developer training

### Failure Scenario 2: Exploitability Assessment Disagreement
- **Symptoms**: Stakeholders disagree on exploitability determination, conflicting risk assessments
- **Root Cause**: Different risk perspectives, ambiguous vulnerability details, insufficient technical analysis
- **Impact**: Medium - Remediation prioritization conflicts, resource allocation disputes
- **Resolution**:
  1. Convene cross-functional security review panel
  2. Conduct detailed technical analysis with proof-of-concept testing
  3. Use threat intelligence and exploit availability data for evidence
  4. Document consensus decision with explicit rationale
  5. Escalate to CISO for final decision if consensus not reached
- **Prevention**: Clear exploitability criteria, standardized assessment methodology, regular calibration

### Failure Scenario 3: VEX Schema Validation Failure
- **Symptoms**: Generated VEX document fails schema validation, incompatible with consuming systems
- **Root Cause**: Incorrect VEX format, schema version mismatch, tool compatibility issues
- **Impact**: Medium - VEX document unusable, integration failures, manual remediation required
- **Resolution**:
  1. Validate VEX document against official CycloneDX schema
  2. Update VEX generation tools to correct schema version
  3. Manually correct schema violations in generated VEX
  4. Test VEX document with consuming systems before publication
  5. Implement automated schema validation in CI/CD pipeline
- **Prevention**: Schema validation in generation process, tool version management, integration testing

### Failure Scenario 4: False Positive Reduction Target Not Met
- **Symptoms**: VEX assessments not reducing false positives, vulnerability alerts remain high
- **Root Cause**: Insufficient context analysis, conservative assessment approach, inadequate tooling
- **Impact**: Medium - Alert fatigue continues, resource waste on non-exploitable vulnerabilities
- **Resolution**:
  1. Review VEX assessment methodology for over-conservatism
  2. Enhance context analysis capabilities with better tooling
  3. Provide additional security analyst training on VEX best practices
  4. Implement more granular exploitability categories
  5. Conduct retrospective analysis of false positive patterns
- **Prevention**: Continuous methodology improvement, tool investment, analyst training, metrics tracking

### Failure Scenario 5: VEX Document Becomes Outdated
- **Symptoms**: Application changes invalidate VEX assessments, new attack vectors emerge
- **Root Cause**: Lack of VEX maintenance, application evolution, new vulnerability disclosures
- **Impact**: High - Inaccurate risk assessments, exploitable vulnerabilities missed, compliance gaps
- **Resolution**:
  1. Establish VEX maintenance schedule (monthly or per release)
  2. Trigger VEX reassessment on significant application changes
  3. Monitor new vulnerability disclosures and update VEX accordingly
  4. Implement automated VEX versioning and change tracking
  5. Integrate VEX updates into CI/CD pipeline
- **Prevention**: Automated reassessment triggers, change detection, continuous monitoring

### Failure Scenario 6: Customer or Partner Rejects VEX Assessments
- **Symptoms**: External stakeholders dispute exploitability determinations, demand remediation
- **Root Cause**: Different risk tolerance, compliance requirements, lack of trust in assessment
- **Impact**: Critical - Business relationship impact, compliance violations, contractual disputes
- **Resolution**:
  1. Provide detailed technical justification with supporting evidence
  2. Offer independent security review or penetration testing
  3. Implement additional compensating controls if remediation not feasible
  4. Negotiate risk acceptance with formal documentation
  5. Escalate to executive leadership for business decision
- **Prevention**: Early stakeholder engagement, transparent assessment process, industry-standard methodologies

## Validation Criteria

### Quantitative Thresholds
- VEX document generation: 100% of SBOM vulnerability analyses
- False positive reduction: ≥40% reduction in actionable vulnerability alerts
- Exploitability assessment coverage: 100% of identified CVEs assessed
- VEX generation time: ≤3 hours (95th percentile for complete analysis)
- Schema validation pass rate: 100% of generated VEX documents
- Reassessment frequency: ≤30 days for VEX maintenance

### Boolean Checks
- VEX document schema compliant (CycloneDX 1.4): Pass/Fail
- All vulnerabilities have exploitability assessment: Pass/Fail
- Exploitability justifications documented: Pass/Fail
- VEX integrated with vulnerability management: Pass/Fail
- Remediation priorities established: Pass/Fail

### Qualitative Assessments
- Exploit ability assessment accuracy: Security team evaluation (≥4/5 rating)
- False positive reduction effectiveness: Development team feedback (≥4/5 rating)
- VEX documentation quality: Compliance officer assessment (≥4/5 rating)

**Overall Success**: All quantitative thresholds met AND all boolean checks pass AND qualitative assessments ≥4/5 rating

## HITL Escalation

### Automatic Triggers
- Exploitability assessment uncertainty requiring expert analysis
- VEX generation failures exceeding retry limit
- Customer/partner VEX disputes requiring resolution
- False positive reduction targets not met requiring methodology review
- Critical vulnerabilities with ambiguous exploitability requiring immediate determination

### Manual Triggers
- Complex application architecture requiring specialized analysis
- Novel vulnerability types lacking established assessment criteria
- Regulatory compliance questions requiring legal interpretation
- Business decisions on accepted risks requiring executive approval

### Escalation Procedure
1. **Level 1 - Security Team Resolution**: Security-Auditor consults with senior security analysts
2. **Level 2 - Cross-Functional Review**: Security, development, and architecture teams collaborate
3. **Level 3 - Executive Risk Decision**: CISO and executive leadership for business risk acceptance
4. **Level 4 - External Validation**: Third-party security experts for independent assessment

## Related Protocols

### Upstream (Prerequisites)
- **SCM-SBOM**: Provides dependency inventory for vulnerability analysis
- **P-SEC-VULN**: Provides vulnerability scanning results requiring assessment
- **P-DEVSECOPS**: Triggers VEX assessment in security pipeline

### Downstream (Consumers)
- **Vulnerability Management Systems**: Consumes VEX assessments for prioritization
- **P-QGATE**: Uses VEX for security gate decisions
- **Compliance Reporting**: Uses VEX for supply chain security evidence

### Alternatives
- **Manual Vulnerability Triage**: Human-led assessment vs. structured VEX protocol
- **CVSS-Only Assessment**: Generic scoring vs. contextual exploitability analysis
- **Vendor VEX Consumption**: Third-party VEX vs. internal generation

## Test Scenarios

### Happy Path Scenarios

#### Scenario 1: Python Dependency VEX Assessment
- **Setup**: SBOM with Python dependencies containing known CVEs, application context available
- **Execution**: Run SCM-VEX with complete context analysis and exploitability assessment
- **Expected Result**: VEX document generated with accurate exploitability determinations, false positives reduced
- **Validation**: VEX schema valid, all CVEs assessed, justifications complete, vulnerability management updated

#### Scenario 2: Container Base Image VEX for Non-Exploitable Vulnerabilities
- **Setup**: Container image with base OS packages containing CVEs, packages not used by application
- **Execution**: Run SCM-VEX determining vulnerabilities not exploitable due to unused components
- **Expected Result**: VEX document classifying vulnerabilities as "not_affected" with "code_not_present" justification
- **Validation**: False positive reduction demonstrated, VEX published with container image

### Failure Scenarios

#### Scenario 3: Insufficient Context Requiring Investigation Status
- **Setup**: Complex application with unclear component usage, incomplete documentation
- **Execution**: Run SCM-VEX with insufficient context triggering "under investigation" status
- **Expected Result**: VEX document generated with provisional assessments, follow-up analysis scheduled
- **Validation**: Uncertainty documented, investigation tasks created, interim VEX published

#### Scenario 4: Customer VEX Dispute Requiring Resolution
- **Setup**: Customer disputes "not_affected" determination, demands remediation
- **Execution**: Run dispute resolution with additional technical justification and evidence
- **Expected Result**: Detailed technical analysis provided, negotiated resolution achieved
- **Validation**: Dispute documented, resolution recorded, customer satisfaction achieved

### Edge Cases

#### Scenario 5: Zero-Day Vulnerability VEX Assessment
- **Setup**: Newly disclosed zero-day vulnerability requiring rapid exploitability determination
- **Execution**: Run expedited SCM-VEX with emergency context analysis
- **Expected Result**: Rapid exploitability assessment with preliminary VEX, full analysis follows
- **Validation**: Rapid response demonstrated, preliminary VEX published within 24 hours

## Metadata

### Version History
| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 1.0 | 2025-10-10 | Initial protocol creation for Epic 111. Comprehensive VEX protocol with context analysis, exploitability assessment, CycloneDX VEX generation, P-RECOVERY integration, 6 failure scenarios, and validation criteria. | Security-Auditor |

### Review Cycle
- **Frequency**: Quarterly (aligned with VEX specification updates)
- **Next Review**: 2026-01-10
- **Reviewers**: Security-Auditor supervisor, CISO, Vulnerability-Management-Team

### Compliance Status
- **Framework Standards**: ✅ Compliant with 14-section protocol template
- **Security Audit**: Required (handles vulnerability risk assessment)
- **Performance Validation**: Required (VEX generation performance SLOs defined)
- **Compliance Review**: Required (CISA VEX guidance, supply chain security)
- **Last Validation**: 2025-10-10

## Performance SLOs

- **Vulnerability inventory time**: ≤15 minutes (Step 1, 95th percentile)
- **Context analysis time**: ≤30 minutes (Step 2, 95th percentile)
- **Exploitability assessment time**: ≤45 minutes (Step 3, 95th percentile)
- **VEX generation time**: ≤20 minutes (Step 4, 95th percentile)
- **Total VEX analysis time**: ≤3 hours (95th percentile)
- **False positive reduction**: ≥40% reduction in actionable alerts
- **VEX coverage**: 100% of SBOM vulnerability analyses
