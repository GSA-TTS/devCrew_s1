rules:
  - id: hardcoded-password
    pattern-either:
      - pattern: password = "..."
      - pattern: PASSWORD = "..."
      - pattern: pwd = "..."
      - pattern: secret = "..."
      - pattern: api_key = "..."
      - pattern: API_KEY = "..."
    message: |
      Hardcoded password or secret detected. Storing credentials in source code
      is a security risk. Use environment variables or secure secret management.

      Example:
        # Bad
        password = "mypassword123"

        # Good
        password = os.environ.get("DB_PASSWORD")
    languages: [python, javascript, typescript, go, java]
    severity: ERROR
    metadata:
      category: security
      cwe:
        - "CWE-798"
      owasp:
        - "A07:2021-Identification and Authentication Failures"
      confidence: MEDIUM

  - id: hardcoded-aws-credentials
    pattern-either:
      - pattern: aws_access_key_id = "AKIA..."
      - pattern: AWS_ACCESS_KEY_ID = "AKIA..."
      - pattern: aws_secret_access_key = "..."
    message: |
      Hardcoded AWS credentials detected. Never commit AWS credentials to
      source control. Use AWS IAM roles or environment variables.

      References:
        - https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html
    languages: [python, javascript, typescript, go, java, yaml]
    severity: ERROR
    metadata:
      category: security
      cwe:
        - "CWE-798"
      owasp:
        - "A07:2021-Identification and Authentication Failures"
      confidence: HIGH

  - id: jwt-secret-hardcoded
    pattern-either:
      - pattern: jwt.encode(..., key="...", ...)
      - pattern: jwt.sign({...}, "...")
    message: |
      JWT secret is hardcoded. JWT signing keys should be stored securely
      in environment variables or secret management systems.

      Example:
        # Bad
        token = jwt.encode(payload, "my-secret-key", algorithm="HS256")

        # Good
        token = jwt.encode(payload, os.environ["JWT_SECRET"], algorithm="HS256")
    languages: [python, javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe:
        - "CWE-798"
      owasp:
        - "A02:2021-Cryptographic Failures"
      confidence: HIGH
